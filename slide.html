<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Googleスライド操作</title>
    <style>
      iframe {
        width: 100%;
        height: 500px;
        border: none;
      }
      button {
        margin: 10px;
        padding: 10px 20px;
        font-size: 16px;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <h1>Googleスライド操作デモ</h1>
    <div>
      <button id="prev">前</button>
      <button id="next">後</button>
      <button id="fullscreenBtn">フルスクリーン</button>
    </div>

    <iframe
      id="slideFrame"
      class="speakerdeck-iframe"
      frameborder="0"
      src="https://speakerdeck.com/player/538158d3f3b94ef888b4ef0a0ac8ca76?slide=1"
      title="今年始めた 「アニメから得た学びを発表会」"
      allowfullscreen="true"
      style="
        border: 0px;
        background: padding-box padding-box rgba(0, 0, 0, 0.1);
        margin: 0px;
        padding: 0px;
        border-radius: 6px;
        box-shadow: rgba(0, 0, 0, 0.2) 0px 5px 40px;
        aspect-ratio: 560 / 315;
        height: auto;
      "
      data-ratio="1.7777777777777777"
    ></iframe>

    <script>
      // スライドのページ番号管理
      let currentSlide = 1; // 最初のスライドページ
      const slideBaseUrl =
        "https://speakerdeck.com/player/538158d3f3b94ef888b4ef0a0ac8ca76"; // 埋め込みURLのベース部分

      // 前のスライド
      document.getElementById("prev").addEventListener("click", () => {
        if (currentSlide > 1) {
          currentSlide--;
          updateSlide();
        }
      });

      // 次のスライド
      document.getElementById("next").addEventListener("click", () => {
        currentSlide++;
        updateSlide();
      });

      // スライドを更新
      function updateSlide() {
        const iframe = document.getElementById("slideFrame");
        iframe.src = `${slideBaseUrl}?slide=${currentSlide}`;
      }

      // フルスクリーン
      const fullscreenBtn = document.getElementById("fullscreenBtn");
      const iframe = document.getElementById("slideFrame");

      fullscreenBtn.addEventListener("click", () => {
        if (iframe.requestFullscreen) {
          iframe.requestFullscreen();
        } else if (iframe.webkitRequestFullscreen) {
          iframe.webkitRequestFullscreen();
        } else if (iframe.msRequestFullscreen) {
          iframe.msRequestFullscreen();
        }
      });
    </script>
  </body>
</html>
